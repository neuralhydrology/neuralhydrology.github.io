<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "post",
        "name" : "The performance of LSTM models from basin to continental scales",
        "headline" : "The performance of LSTM models from basin to continental scales",
        "description" : "\u003cp\u003eVirtual presentation at the EGU General Assembly 2020 comparing LSTMs trained for each basin individually with a single LSTM trained for all basins together.\u003c\/p\u003e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2020",
        "datePublished": "2020-05-04 20:23:59 \u002b0530 \u002b0530",
        "dateModified" : "2020-05-04 20:23:59 \u002b0530 \u002b0530",
        "url" : "\/post\/research\/kratzert2020egu1\/",
        "wordCount" : "484",
        "image" : "/img/kratzert2020egu/header.png"",
        "keywords" : [ "Blog" ]   
    }
    </script>


 <title>The performance of LSTM models from basin to continental scales </title>


<meta name="description" content="Research blog for machine learning applications in hydrology" />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

<link href="/css/style.css?v=1610458361" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="/css/custom.css?v=1610458361" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">


</head>


<body
  class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">
  
  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fas fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/book-chapter">book-chapter</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/code">code</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/conference">conference</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/paper">paper</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/video">video</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/workshops">workshops</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    

    

    

    

    


    


    

    


  </ul></div>

      </div>

      <div class="container">
        <head>
<style>
.center {
  margin: auto;
  text-align: center;
  width: 60%;
  padding: 10px;
}
</style>
</head>

<div id="headerino" class = "left">
  <a href="/">
  <img src="/img/neural-hyd-head.png" width="240">
  </a>
  <br>
</div>

<div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Neural Hydrology </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fas fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-custom menu-item-object-custom '>
          <a href="/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/about/">About</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/library/">Python Library</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      

  
  
  
  
  
  <div id="loop-container2" class="loop-container2">
    
    <div
      class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image'  data-background="/img/kratzert2020egu/header.png"
        >
      </div>
      
        <div class="entry-meta">
          <span class="date">04 May</span> <span> / </span>

          <span class="author">
            <a href="https://kratzert.github.io" title="Posts by Frederik Kratzert"
              rel="author">Frederik Kratzert</a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/conference">conference</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> The performance of LSTM models from basin to continental scales</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <p>Virtual presentation at the EGU General Assembly 2020 comparing LSTMs trained for each basin individually with a single LSTM trained for all basins together.</p>
<h4 id="abstract"><strong>Abstract</strong></h4>
<p>Simulation accuracy among traditional hydrological models usually degrades significantly when going from single basin to regional scale. Hydrological models perform best when calibrated for specific basins, and do worse when a regional calibration scheme is used.</p>
<p>One reason for this is that these models do not (have to) learn hydrological processes from data. Rather, they have a predefined model structure and only a handful of parameters adapt to specific basins. This often yields less-than-optimal parameter values when the loss is not determined by a single basin, but by many through regional calibration.</p>
<p>The opposite is true for data driven approaches where models tend to get better with more and diverse training data. We examine whether this holds true when modeling rainfall-runoff processes with deep learning, or if, like their process-based counterparts, data-driven hydrological models degrade when going from basin to regional scale.</p>
<p>Recently, Kratzert et al. (2018) showed that the Long Short-Term Memory network (LSTM), a special type of recurrent neural network, achieves comparable performance to the SAC-SMA at basin scale. In follow up work Kratzert et al. (2019a) trained a single LSTM for hundreds of basins in the continental US, which outperformed a set of hydrological models significantly, even compared to basin-calibrated hydrological models. On average, a single LSTM is even better in out-of-sample predictions (ungauged) compared to the SAC-SMA in-sample (gauged) or US National Water Model (Kratzert et al. 2019b).</p>
<p>LSTM-based approaches usually involve tuning a large number of hyperparameters, such as the number of neurons, number of layers, and learning rate, that are critical for the predictive performance. Therefore, large-scale hyperparameter search has to be performed to obtain a proficient LSTM network.</p>
<p>However, in the abovementioned studies, hyperparameter optimization was not conducted at large scale and e.g. in Kratzert et al. (2018) the same network hyperparameters were used in all basins, instead of tuning hyperparameters for each basin separately. It is yet unclear whether LSTMs follow the same trend of traditional hydrological models to degrade performance from basin to regional scale.</p>
<p>In the current study, we performed a computational expensive, basin-specific hyperparameter search to explore how site-specific LSTMs differ in performance compared to regionally calibrated LSTMs. We compared our results to the mHM and VIC models, once calibrated per-basin and once using an MPR regionalization scheme. These benchmark models were calibrated individual research groups, to eliminate bias in our study. We analyse whether differences in basin-specific vs regional model performance can be linked to basin attributes or data set characteristics.</p>
<h4 id="links"><strong>Links</strong></h4>
<p><a href="https://meetingorganizer.copernicus.org/EGU2020/EGU2020-8855.html">Abstract</a></p>
<p><a href="https://presentations.copernicus.org/EGU2020/EGU2020-8855_presentation.pdf">Slides</a></p>
<h4 id="citation"><strong>Citation</strong></h4>
<pre><code>@inproceedings{kratzert2020basintocontinent,
  title={The performance of LSTM models from basin to continental scales},
  author={Kratzert, F. and Klotz, D. and Shalev, G. and Nevo, S. and Klambauer, G. and Nearing, G. and Hochreiter, S. },
  booktitle={EGU General Assembly 2020},
  venue={Vienna, Austria},
  date={4-8 May},
  year={2020}
}
</code></pre>
            </article>
          </div>
          
          <div class='entry-meta-bottom'>
            

            <div class="entry-categories">
              <p><span>Categories</span>
                
                <a href="/categories/conference"
                  title="View all posts in conference">conference</a>
              </p>
            </div>


            
            

            <section id="comments" class="comments">
              

              

              


            </section>
          </div>

          
          


          
    </div>


  </div>
  <footer id="site-footer" class="site-footer" role="contentinfo">
    <h1>
        
        <a href=""> Neural Hydrology </a>
        
    </h1>

    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div id="menu-footer" class="menu-container menu-footer" role="navigation">
        <div class="menu">

            <ul id="menu-footer-items" class="menu-footer-items">
                
            </ul>

        </div>
    </div>


    <div class="design-credit">
        
        <p>© 2018 Göran Svensson</p>
        
        <p>Nederburg Hugo Theme by <a href="https://appernetic.io">Appernetic</a>.</p>
        
        <p>A port of Tracks by Compete Themes.</p>
        
    </div>
</footer>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquerymigrate.js"></script>
<script src="/js/production.min.js?v=1610458361"></script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>


</body>
</html>
