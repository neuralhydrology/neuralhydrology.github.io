<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "post",
        "name" : "Large-scale river network modeling using Graph Neural Networks",
        "headline" : "Large-scale river network modeling using Graph Neural Networks",
        "description" : "\x3cp\x3eOral presentation at the virtual EGU General Assembly 2021 on rainfall–runoff prediction with Graph Neural Networks.\x3c\/p\x3e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2021",
        "datePublished": "2021-05-07 17:20:55 \x2b0530 \x2b0530",
        "dateModified" : "2021-05-07 17:20:55 \x2b0530 \x2b0530",
        "url" : "\/post\/research\/kratzert2021egu\/",
        "wordCount" : "497",
        "image" : "/img/kratzert2021egu/kratzert2021egu.png"",
        "keywords" : [ "Blog" ]   
    }
    </script>


 <title>Large-scale river network modeling using Graph Neural Networks </title>


<meta name="description" content="Research blog for machine learning applications in hydrology" />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

<link href="/css/style.css?v=1643663517" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="/css/custom.css?v=1643663517" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">


</head>


<body
  class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">
  
  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fas fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/book-chapter">book-chapter</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/code">code</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/conference">conference</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/dataset">dataset</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/paper">paper</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/video">video</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/workshops">workshops</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    

    

    

    

    


    


    

    


  </ul></div>

      </div>

      <div class="container">
        <head>
<style>
.center {
  margin: auto;
  text-align: center;
  width: 60%;
  padding: 10px;
}
</style>
</head>

<div id="headerino" class = "left">
  <a href="/">
  <img src="/img/neural-hyd-head.png" width="240">
  </a>
  <br>
</div>

<div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Neural Hydrology </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fas fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-custom menu-item-object-custom '>
          <a href="/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/about/">About</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/library/">Python Library</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      

  
  
  
  
  
  <div id="loop-container2" class="loop-container2">
    
    <div
      class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image'  data-background="/img/kratzert2021egu/kratzert2021egu.png"
        >
      </div>
      
        <div class="entry-meta">
          <span class="date">07 May</span> <span> / </span>

          <span class="author">
            <a href="/" title="Posts by Martin Gauch"
              rel="author">Martin Gauch</a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/conference">conference</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Large-scale river network modeling using Graph Neural Networks</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <p>Oral presentation at the virtual EGU General Assembly 2021 on rainfall–runoff prediction with Graph Neural Networks.</p>
<h4 id="abstract"><strong>Abstract</strong></h4>
<p>In the recent past, several studies have demonstrated the ability of deep learning (DL) models, especially based on Long Short-Term Memory (LSTM) networks, for rainfall-runoff modeling. However, almost all of these studies were limited to (multiple) individual catchments or small river networks, consisting of only a few connected catchments.</p>
<p>In this study, we investigate large-scale, spatially distributed rainfall-runoff modeling using DL models. Our setup consists of two independent model components: One model for the runoff-generation process and one for the routing. The former is an LSTM-based model that predicts the discharge contribution of each sub-catchment in a river network. The latter is a Graph Neural Network (GNN) that routes the water along the river network network in hierarchical order. The first part is set up to simulate unimpaired runoff for every sub-catchment. Then, the GNN routes the water through the river network, incorporating human influences such as river regulations through hydropower plants. The main focus is to investigate different model architectures for the GNN that are able to learn the routing task, as well as potentially accounting for human influence. We consider models based on 1D-convolution, attention modules, as well as state-aware time series models.</p>
<p>The decoupled approach with individual models for sub-catchment discharge prediction and routing has several benefits: a) We have an intermediate output of per-basin discharge contributions that we can inspect. b) We can leverage observed streamflow when available. That is, we can optionally substitute the discharge simulations of the first model with observed discharge, to make use of as much observed information as possible. c) We can train the model very efficiently. d) We can simulate any intermediate node in the river network, without requiring discharge observations.</p>
<p>For the experiments, we use a new large-sample dataset called LamaH (Large-sample Data for Hydrology in Central Europe) that covers all of Austria and the foreign upstream areas of the Danube. We consider the entire Danube catchment upstream of Bratislava, a highly diverse region, including large parts of the Alps, that covers a total area of more than 130000km2. Within that area, LamaH contains hourly and daily discharge observations for more than 600 gauge stations. Thus, we investigate DL-based routing models not only for daily discharge, but also for hourly discharge.</p>
<p>Our first results are promising, both daily and hourly discharge simulation. For example, the fully DL-based distributed models capture the dynamics as well as the timing of the devastating 2002 Danube flood. Building upon our work on learning universal, regional, and local hydrological behaviors with machine learning, we try to make the GNN-based routing as universal as possible, striving towards a globally applicable, spatially distributed, fully learned hydrological model.</p>
<h4 id="links"><strong>Links</strong></h4>
<p><a href="https://doi.org/10.5194/egusphere-egu21-13375">Abstract</a></p>
<h4 id="citation"><strong>Citation</strong></h4>
<pre><code>@inproceedings{kratzert2021egu,
  title={Large-scale river network modeling using Graph Neural Networks},
  author={Kratzert, Frederik and Klotz, Daniel and Gauch, Martin and Klingler, Christoph and Nearing, Grey and Hochreiter, Sepp},
  booktitle={EGU General Assembly 2021},
  venue={online},
  date={19-30 April},
  year={2021},
  doi={10.5194/egusphere-egu21-13375}
}
</code></pre>
            </article>
          </div>
          
          <div class='entry-meta-bottom'>
            

            <div class="entry-categories">
              <p><span>Categories</span>
                
                <a href="/categories/conference"
                  title="View all posts in conference">conference</a>
              </p>
            </div>


            
            

            <section id="comments" class="comments">
              

              

              


            </section>
          </div>

          
          


          
    </div>


  </div>
  <footer id="site-footer" class="site-footer" role="contentinfo">
    <h1>
        
        <a href=""> Neural Hydrology </a>
        
    </h1>

    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div id="menu-footer" class="menu-container menu-footer" role="navigation">
        <div class="menu">

            <ul id="menu-footer-items" class="menu-footer-items">
                
            </ul>

        </div>
    </div>


    <div class="design-credit">
        
        <p>© 2018 Göran Svensson</p>
        
        <p>Nederburg Hugo Theme by <a href="https://appernetic.io">Appernetic</a>.</p>
        
        <p>A port of Tracks by Compete Themes.</p>
        
    </div>
</footer>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquerymigrate.js"></script>
<script src="/js/production.min.js?v=1643663517"></script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>


</body>
</html>
