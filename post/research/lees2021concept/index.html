<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "post",
        "name" : "Hydrological Concept Formation inside Long Short-Term Memory (LSTM) networks ",
        "headline" : "Hydrological Concept Formation inside Long Short-Term Memory (LSTM) networks ",
        "description" : "\u003cp\u003eIn this paper, we investigate what information the LSTM captures about the hydrological system.\u003c\/p\u003e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2022",
        "datePublished": "2022-06-20 20:23:59 \u002b0530 \u002b0530",
        "dateModified" : "2022-06-20 20:23:59 \u002b0530 \u002b0530",
        "url" : "\/post\/research\/lees2021concept\/",
        "wordCount" : "499",
        "image" : "\/img\/hyd_model.png",
        "keywords" : [ "Blog" ]   
    }
    </script>

 <title>Hydrological Concept Formation inside Long Short-Term Memory (LSTM) networks  </title>


<meta name="description" content="Research blog for machine learning applications in hydrology" />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

<link href="/css/style.css?v=1707313023" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="/css/custom.css?v=1707313023" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">


</head>


<body
  class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">
  
  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fas fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/book-chapter">book-chapter</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/code">code</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/conference">conference</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/dataset">dataset</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/paper">paper</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/video">video</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/workshops">workshops</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    

    

    

    

    


    


    

    


  </ul></div>

      </div>

      <div class="container">
        <head>
<style>
.center {
  margin: auto;
  text-align: center;
  width: 60%;
  padding: 10px;
}
</style>
</head>

<div id="headerino" class = "left">
  <a href="/">
  <img src="/img/neural-hyd-head.png" width="240">
  </a>
  <br>
</div>

<div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Neural Hydrology </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fas fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-custom menu-item-object-custom '>
          <a href="/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/about/">About</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/library/">Python Library</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      

  
  
  
  
  
  <div id="loop-container2" class="loop-container2">
    
    <div
      class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image'  data-background="/img/hyd_model.png"
        >
      </div>
      
        <div class="entry-meta">
          <span class="date">20 June 2022</span> <span> / </span>

          <span class="author">
            <a href="https://kratzert.github.io" title="Posts by Frederik Kratzert"
              rel="author">Frederik Kratzert</a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/paper">paper</a>
          </span>
          
          <span class="category">
            <span> / </span>

            <a href="/categories/code">code</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Hydrological Concept Formation inside Long Short-Term Memory (LSTM) networks </h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <p>In this paper, we investigate what information the LSTM captures about the hydrological system.</p>
<h4 id="abstract"><strong>Abstract</strong></h4>
<p>Neural networks have been shown to be extremely effective rainfall-runoff models, where the river discharge is predicted from meteorological inputs. However, the question remains: what have these models learned? Is it possible to extract information about the learned relationships that map inputs to outputs, and do these mappings represent known hydrological concepts? Small-scale experiments have demonstrated that the internal states of long short-term memory networks (LSTMs), a particular neural network architecture predisposed to hydrological modelling, can be interpreted. By extracting the tensors which represent the learned translation from inputs (precipitation, temperature, and potential evapotranspiration) to outputs (discharge), this research seeks to understand what information the LSTM captures about the hydrological system. We assess the hypothesis that the LSTM replicates real-world processes and that we can extract information about these processes from the internal states of the LSTM. We examine the cell-state vector, which represents the memory of the LSTM, and explore the ways in which the LSTM learns to reproduce stores of water, such as soil moisture and snow cover. We use a simple regression approach to map the LSTM state vector to our target stores (soil moisture and snow). Good correlations (R2&gt;0.8) between the probe outputs and the target variables of interest provide evidence that the LSTM contains information that reflects known hydrological processes comparable with the concept of variable-capacity soil moisture stores.</p>
<p>The implications of this study are threefold: (1) LSTMs reproduce known hydrological processes. (2) While conceptual models have theoretical assumptions embedded in the model a priori, the LSTM derives these from the data. These learned representations are interpretable by scientists. (3) LSTMs can be used to gain an estimate of intermediate stores of water such as soil moisture. While machine learning interpretability is still a nascent field and our approach reflects a simple technique for exploring what the model has learned, the results are robust to different initial conditions and to a variety of benchmarking experiments. We therefore argue that deep learning approaches can be used to advance our scientific goals as well as our predictive goals.</p>
<h4 id="paper"><strong>Paper</strong></h4>
<p><a href="https://hess.copernicus.org/articles/26/3079/2022/">Lees, T., Reece, S., Kratzert, F., Klotz, D., Gauch, M., De Bruijn, J., Kumar Sahu, R., Greve, P., Slater, L., and Dadson, S. J.: Hydrological concept formation inside long short-term memory (LSTM) networks, Hydrol. Earth Syst. Sci., 26, 3079–3101, https://doi.org/10.5194/hess-26-3079-2022, 2022. </a></p>
<h4 id="code"><strong>Code</strong></h4>
<p>The results of this paper were produced with the <a href="https://github.com/neuralhydrology/neuralhydrology">NeuralHydrology</a> Python package. The exact snapshot to reproduce all results can be found in <a href="https://github.com/tommylees112/neuralhydrology/tree/pixel">this</a> Github repository. The pretrained models can be found <a href="https://doi.org/10.5281/zenodo.5600851">here</a>.</p>
<h4 id="citation"><strong>Citation</strong></h4>
<pre tabindex="0"><code>@Article{lees2021concept,
author = {Lees, T. and Reece, S. and Kratzert, F. and Klotz, D. and Gauch, M. and De Bruijn, J. and Kumar Sahu, R. and Greve, P. and Slater, L. and Dadson, S.},
title = {Hydrological Concept Formation inside Long Short-Term Memory (LSTM) networks},
journal = {Hydrology and Earth System Sciences Discussions},
volume = {2021},
year = {2021},
pages = {1--37},
doi = {10.5194/hess-2021-566}
}
</code></pre>
            </article>
          </div>
          
          <div class='entry-meta-bottom'>
            

            <div class="entry-categories">
              <p><span>Categories</span>
                
                <a href="/%20/categories/paper"
                  title="View all posts in paper">paper</a>
                <a href="/%20/categories/code"
                  title="View all posts in code">code</a>
              </p>
            </div>


            
            

            <section id="comments" class="comments">
              

              

              


            </section>
          </div>

          
          


          
    </div>


  </div>
  <footer id="site-footer" class="site-footer" role="contentinfo">
    <h1>
        
        <a href=""> Neural Hydrology </a>
        
    </h1>

    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div id="menu-footer" class="menu-container menu-footer" role="navigation">
        <div class="menu">

            <ul id="menu-footer-items" class="menu-footer-items">
                
            </ul>

        </div>
    </div>


    <div class="design-credit">
        
        <p>Modified design by Frederik Kratzert &amp; Daniel Klotz.</p>
        
        <p>Original design by Göran Svensson (2018):</p>
        
        <p><a href="https://github.com/appernetic/hugo-nederburg-theme">Nederburg Theme</a> by <a href="https://github.com/appernetic">Appernetic</a> (a port of <a href="https://www.competethemes.com/tracks/">Tracks</a>).</p>
        
    </div>
</footer>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquerymigrate.js"></script>
<script src="/js/production.min.js?v=1707313023"></script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>


</body>
</html>
