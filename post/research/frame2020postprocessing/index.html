<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<script type="application/ld+json">
    {
        "@context" : "http://schema.org",
        "@type" : "BlogPosting",
        "mainEntityOfPage": {
             "@type": "WebPage",
             "@id": "\/"
        },
        "articleSection" : "post",
        "name" : "Post processing the U.S. National Water Model with a Long Short-Term Memory network",
        "headline" : "Post processing the U.S. National Water Model with a Long Short-Term Memory network",
        "description" : "\x3cp\x3eIn this paper, we investigate the potential of using the LSTM as a post-processor for the US National Water Model.\x3c\/p\x3e",
        "inLanguage" : "en",
        "author" : "",
        "creator" : "",
        "publisher": "",
        "accountablePerson" : "",
        "copyrightHolder" : "",
        "copyrightYear" : "2021",
        "datePublished": "2021-11-15 20:23:59 \x2b0530 \x2b0530",
        "dateModified" : "2021-11-15 20:23:59 \x2b0530 \x2b0530",
        "url" : "\/post\/research\/frame2020postprocessing\/",
        "wordCount" : "348",
        "image" : "/img/frame2021postprocessing/header.png"",
        "keywords" : [ "Blog" ]   
    }
    </script>


 <title>Post processing the U.S. National Water Model with a Long Short-Term Memory network </title>


<meta name="description" content="Research blog for machine learning applications in hydrology" />



<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

<link href="/css/style.css?v=1643743042" rel="stylesheet" id="theme-stylesheet" type='text/css' media='all'>

<link href="/css/custom.css?v=1643743042" rel="stylesheet" type='text/css' media='all'>
<link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
<link rel="icon" href="/img/favicon.ico" type="image/x-icon">


</head>


<body
  class="post-template-default single single-post single-format-standard ct-body singular singular-post not-front standard">
  
  <div id="overflow-container" class="overflow-container">
    <a class="skip-content" href="#main">Skip to content</a>
    <header id="site-header" class="site-header" role="banner">
      <div class='top-navigation'>
        <div class='container'>

  <div id="menu-secondary" class="menu-container menu-secondary" role="navigation">
    <button id="toggle-secondary-navigation" class="toggle-secondary-navigation"><i class="fas fa-plus"></i></button>

    <div class="menu">

      <ul id="menu-secondary-items" class="menu-secondary-items">
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/book-chapter">book-chapter</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/code">code</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/conference">conference</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/dataset">dataset</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/paper">paper</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/video">video</a>
        </li>
        
        <li id="menu-item" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item">
          <a href="/categories/workshops">workshops</a>
        </li>
        

      </ul>

    </div>

  </div>


  <ul class="social-media-icons">


    

    

    

    

    

    

    


    


    

    


  </ul></div>

      </div>

      <div class="container">
        <head>
<style>
.center {
  margin: auto;
  text-align: center;
  width: 60%;
  padding: 10px;
}
</style>
</head>

<div id="headerino" class = "left">
  <a href="/">
  <img src="/img/neural-hyd-head.png" width="240">
  </a>
  <br>
</div>

<div id="title-info" class="title-info">
  <div id='site-title' class='site-title'>
    
    <a href="/"> Neural Hydrology </a>
    </div>
  </div>
  <button id="toggle-navigation" class="toggle-navigation">
    <i class="fas fa-bars"></i>
  </button>

  <div id="menu-primary-tracks" class="menu-primary-tracks"></div>
  <div id="menu-primary" class="menu-container menu-primary" role="navigation">
    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div class="menu">
      <ul id="menu-primary-items" class="menu-primary-items">
        
        
        <li id="menu-item" class='menu-item menu-item-type-custom menu-item-object-custom '>
          <a href="/">Home</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/about/">About</a>
          
        </li>
        
        <li id="menu-item" class='menu-item menu-item-type-post_type menu-item-object-page '>
          <a href="/library/">Python Library</a>
          
        </li>
        
      </ul>
    </div>

  </div>

      </div>
    </header>

    <div id="main" class="main" role="main">

      

  
  
  
  
  
  <div id="loop-container2" class="loop-container2">
    
    <div
      class="post type-post status-publish format-standard has-post-thumbnail hentry category-design tag-design tag-standard-2 tag-tagalicious tag-travel entry full-without-featured odd excerpt-1">

      <div class='featured-image lazy lazy-bg-image'  data-background="/img/frame2021postprocessing/header.png"
        >
      </div>
      
        <div class="entry-meta">
          <span class="date">15 November</span> <span> / </span>

          <span class="author">
            <a href="https://kratzert.github.io" title="Posts by Frederik Kratzert"
              rel="author">Frederik Kratzert</a>
          </span>


          
          <span class="category">
            <span> / </span>

            <a href="/categories/paper">paper</a>
          </span>
          
          <span class="category">
            <span> / </span>

            <a href="/categories/code">code</a>
          </span>
          


        </div>
        <div class='entry-header'>
          <h1 class='entry-title'> Post processing the U.S. National Water Model with a Long Short-Term Memory network</h1>
        </div>
        <div class="entry-container">
          <div class="entry-content">
            <article>
              <p>In this paper, we investigate the potential of using the LSTM as a post-processor for the US National Water Model.</p>
<h4 id="abstract"><strong>Abstract</strong></h4>
<p>We build three long short-term memory (LSTM) daily streamflow prediction models (deep learning networks) for 531 basins across the contiguous United States (CONUS), and compare their performance: (1) a LSTM post-processor trained on the United States National Water Model (NWM) outputs (LSTM_PP), (2) a LSTM post-processor trained on the NWM outputs and atmospheric forcings (LSTM_PPA), and (3) a LSTM model trained only on atmospheric forcing (LSTM_A). We trained the LSTMs for the period 2004–2014 and evaluated on 1994–2002, and compared several performance metrics to the NWM reanalysis. Overall performance of the three LSTMs is similar, with median NSE scores of 0.73 (LSTM_PP), 0.75 (LSTM_PPA), and 0.74 (LSTM_A), and all three LSTMs outperform the NWM validation scores of 0.62. Additionally, LSTM_A outperforms LSTM_PP and LSTM_PPA in ungauged basins. While LSTM as a post-processor improves NWM predictions substantially, we achieved comparable performance with the LSTM trained without the NWM outputs (LSTM_A). Finally, we performed a sensitivity analysis to diagnose the land surface component of the NWM as the source of mass bias error and the channel router as a source of simulation timing error. This indicates that the NWM channel routing scheme should be considered a priority for NWM improvement.</p>
<h4 id="paper"><strong>Paper</strong></h4>
<p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/1752-1688.12964">Frame, J.M., Kratzert, F., Raney, A., Rahman, M., Salas, F.R., and Nearing, G.S.. 2021. “ Post-Post-Processing the National Water Model with Long Short-Term Memory Networks for Streamflow Predictions and Model Diagnostics.” Journal of the American Water Resources Association 57( 6): 885– 905. https://doi.org/10.1111/1752-1688.12964. </a></p>
<p>(submitted to WRR)</p>
<h3 id="code">Code</h3>
<p>Code for reproducing the results can be found in <a href="https://github.com/jmframe/nwm-post-processing-with-lstm">this</a> GitHub repository.</p>
<h4 id="citation"><strong>Citation</strong></h4>
<pre><code>@article{frame2021postprocessing,
author = {Frame, J. M. and Kratzert, F. and Raney II, A. and Rahman, M. and Salas, F. R. and Nearing, G. S.},
title = {Post-Processing the National Water Model with Long Short-Term Memory Networks for Streamflow Predictions and Model Diagnostics},
journal = {JAWRA Journal of the American Water Resources Association},
volume = {57},
number = {6},
pages = {885-905},
doi = {https://doi.org/10.1111/1752-1688.12964},
year = {2021}
}
</code></pre>
            </article>
          </div>
          
          <div class='entry-meta-bottom'>
            

            <div class="entry-categories">
              <p><span>Categories</span>
                
                <a href="/categories/paper"
                  title="View all posts in paper">paper</a>
                <a href="/categories/code"
                  title="View all posts in code">code</a>
              </p>
            </div>


            
            

            <section id="comments" class="comments">
              

              

              


            </section>
          </div>

          
          


          
    </div>


  </div>
  <footer id="site-footer" class="site-footer" role="contentinfo">
    <h1>
        
        <a href=""> Neural Hydrology </a>
        
    </h1>

    
    <p class="site-description">Using Neural Networks in Hydrology</p>
    

    <div id="menu-footer" class="menu-container menu-footer" role="navigation">
        <div class="menu">

            <ul id="menu-footer-items" class="menu-footer-items">
                
            </ul>

        </div>
    </div>


    <div class="design-credit">
        
        <p>© 2018 Göran Svensson</p>
        
        <p>Nederburg Hugo Theme by <a href="https://appernetic.io">Appernetic</a>.</p>
        
        <p>A port of Tracks by Compete Themes.</p>
        
    </div>
</footer>
  <script src="/js/jquery.min.js"></script>
<script src="/js/jquerymigrate.js"></script>
<script src="/js/production.min.js?v=1643743042"></script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>


</body>
</html>
